@startuml Supervision R√©seau - Vue Client (Simplifi√©)

title Syst√®me de Supervision R√©seau via SNMP\nFlux Client Simplifi√©

skinparam backgroundColor #F5F5F5
skinparam sequenceArrowThickness 2
skinparam roundcorner 10

actor "üë§ Client\nAdministrateur" as Client
participant "üåê Dashboard\nWeb" as Dashboard
participant "‚è∞ Moteur\nde Polling" as Engine
participant "üåç √âquipements\nR√©seau" as Equipment
participant "üíæ Base de\nDonn√©es" as DB
participant "üìß Syst√®me\nde Notification" as Notify

== Phase 1: Acc√®s √† l'Application ==
Client -> Dashboard: 1Ô∏è‚É£ Se connecter
activate Dashboard
Dashboard -> Dashboard: V√©rifier identifiants
Dashboard --> Client: ‚úÖ Acc√®s autoris√©\n(Dashboard charg√©)
deactivate Dashboard

== Phase 2: Surveillance Temps R√©el (Boucle Automatique) ==

par Polling Automatique Continu
  Engine -> Engine: üì° D√©marrage moteur (15 sec intervalle)
  
  loop Toutes les 15 secondes
    Engine -> Equipment: üîç Scanner tous les √©quipements
    activate Equipment
    Equipment --> Engine: üìä Mesures SNMP re√ßues\n(CPU, RAM, Storage, Interfaces, ...)
    deactivate Equipment
    
    Engine -> DB: üíæ Stocker mesures
    activate DB
    DB --> Engine: ‚úÖ Sauvegard√©
    deactivate DB
    
    Engine -> Engine: ‚úîÔ∏è V√©rifier seuils\n(warning, critical)
    
    alt Seuil D√©pass√© (Alerte)
      Engine -> Notify: üö® D√©clencher alerte
      activate Notify
      Notify -> Notify: üìß Pr√©parer email
      Notify --> Engine: ‚úÖ Notification envoy√©e
      deactivate Notify
    end
    
    Engine -> Engine: üîÑ Prochaine it√©ration...
  end
end par

== Phase 3: Consultation du Dashboard ==
Client -> Dashboard: 2Ô∏è‚É£ Consulter statut √©quipements
activate Dashboard
Dashboard -> DB: R√©cup√©rer statuts + m√©triques fresh
activate DB
DB --> Dashboard: üü¢ UP / üî¥ DOWN / ‚ö†Ô∏è D√©grad√©
deactivate DB

Dashboard -> Dashboard: üìä Afficher:\n‚úì Statut des 20+ √©quipements\n‚úì Historiques graphiques\n‚úì CPU, RAM, Stockage en %\n‚úì Interfaces r√©seau (√©tat)
Dashboard --> Client: üìà Dashboard temps r√©el
deactivate Dashboard

== Phase 4: Affichage des Alertes ==
Client -> Dashboard: 3Ô∏è‚É£ Consulter les alertes
activate Dashboard
Dashboard -> DB: Lire toutes les alertes actives
activate DB
DB --> Dashboard: Liste des ‚ö†Ô∏è warnings\nListe des üö® critiques
deactivate DB

Dashboard -> Dashboard: Afficher:\n‚úì Alertes non acquitt√©es\n‚úì S√©v√©rit√© (info/warning/critical)\n‚úì Date/heure\n‚úì √âquipement affect√©\n‚úì Description du probl√®me
Dashboard --> Client: üö® Tableau de bord alertes
deactivate Dashboard

== Phase 5: Gestion d'une Alerte ==
Client -> Dashboard: 4Ô∏è‚É£ Acquitter une alerte
activate Dashboard
Dashboard -> DB: Marquer alerte comme "acknowledged"
activate DB
DB --> Dashboard: ‚úÖ Alerte acquitt√©e
deactivate DB
Dashboard --> Client: ‚úÖ Confirmation
deactivate Dashboard

note right of Client
  L'alerte reste en base,
  mais est marqu√©e comme vue
end note

== Phase 6: Configuration & Maintenance ==
Client -> Dashboard: 5Ô∏è‚É£ Ajouter nouvel √©quipement
activate Dashboard
Dashboard -> Dashboard: Afficher formulaire ajout
Dashboard --> Client: Formulaire (IP, SNMP Community, Seuils, ...)
deactivate Dashboard

Client -> Dashboard: Remplir donn√©es + valider
activate Dashboard
Dashboard -> DB: INSERT √©quipement
activate DB
DB --> Dashboard: ‚úÖ Nouvel host cr√©√©
deactivate DB

Engine -> Equipment: Prochaine it√©ration:\nüîç Scan automatique du nouvel √©quipement
activate Equipment
Equipment --> Engine: üìä M√©triques disponibles
deactivate Equipment

Dashboard --> Client: ‚úÖ √âquipement surveill√©
deactivate Dashboard

== Phase 7: Gestion des Seuils ==
Client -> Dashboard: 6Ô∏è‚É£ Configurer seuils personnalis√©s
activate Dashboard
Dashboard -> Dashboard: Afficher √©cran config
Dashboard --> Client: Thresholds: CPU 80%‚Üó warning, 90%‚Üó critical
deactivate Dashboard

Client -> Dashboard: Modifier: CPU warning‚Üí70%, critical‚Üí85%
activate Dashboard
Dashboard -> DB: UPDATE seuils pour cet h√¥te
activate DB
DB --> Dashboard: ‚úÖ Seuils mis √† jour
deactivate DB

Engine -> Engine: Prochaines alertes avec NEW seuils
Dashboard --> Client: ‚úÖ Configuration appliqu√©e
deactivate Dashboard

== Phase 8: Gestion des Utilisateurs (Admin) ==
Client -> Dashboard: 7Ô∏è‚É£ Ajouter nouvel op√©rateur
activate Dashboard
Dashboard -> Dashboard: @admin_required
Dashboard -> Dashboard: Afficher page users
Dashboard --> Client: Formulaire: username, email, r√¥le (admin/operator)
deactivate Dashboard

Client -> Dashboard: Cr√©er compte + cocher "recevoir alertes"
activate Dashboard
Dashboard -> DB: INSERT utilisateur (receive_alerts=1)
activate DB
DB --> Dashboard: ‚úÖ Nouvel user cr√©√©
deactivate DB

note right of DB
  Le nouvel op√©rateur recevra
  les emails d'alertes critiques
end note

Dashboard --> Client: ‚úÖ Utilisateur cr√©√©
deactivate Dashboard

== Phase 9: R√©ception des Notifications ==
Notify -> Notify: üìß Une alerte critique se d√©clenche\n(ex: RAM > 95%)
activate Notify

Notify -> Notify: R√©cup√©rer emails users\n(receive_alerts=True)

Notify -> Notify: Envoyer via Gmail SMTP:\nSubject: "‚ö†Ô∏è CRITIQUE - Host XYZ RAM √©lev√©e"\nBody: Description + valeur d√©taill√©e
Notify -> Client: üìß Email re√ßu
Client -> Client: Consulter alerte dans inbox

note right of Notify
  Notification instantan√©e
  via Gmail (TLS 587)
  - Op√©rateurs avertis imm√©diatement
  - Historique en base de donn√©es
end note

deactivate Notify

== R√©sum√© des Avantages ==
note over Client, Notify
  ‚úÖ **Supervision Automatique & Temps R√©el**
  ‚Ä¢ Scan SNMP toutes les 15 secondes
  ‚Ä¢ D√©tection automatique des probl√®mes
  ‚Ä¢ Alertes imm√©diates par email
  
  ‚úÖ **Interface Web Intuitive**
  ‚Ä¢ Statut des √©quipements en 1 coup d'≈ìil
  ‚Ä¢ Historiques graphiques (trends)
  ‚Ä¢ Configuration simple par formulaires web
  
  ‚úÖ **Gestion des Alertes**
  ‚Ä¢ Seuils personnalisables par √©quipement
  ‚Ä¢ Acquittement des alertes
  ‚Ä¢ Historique complet des √©v√©nements
  
  ‚úÖ **Scalabilit√©**
  ‚Ä¢ Support multi-utilisateurs (admin, operators)
  ‚Ä¢ Base de donn√©es MySQL pour scalabilit√©
  ‚Ä¢ Logs centralis√©s pour audit
end note

@enduml
