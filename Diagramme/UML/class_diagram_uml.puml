@startuml
!theme plain
skinparam backgroundColor #FEFEFE
skinparam classBackgroundColor #E3F2FD
skinparam classBorderColor #1565C0
skinparam arrowColor #1565C0
skinparam fontSize 11
skinparam maxMessageSize 250

' ============================================================================
' COUCHE 1: AUTHENTIFICATION & GESTION UTILISATEURS
' ============================================================================

class Utilisateur {
  - username : string
  - email : string
  - motDePasse : string
  - role : string
  - actif : boolean
  - receive_alerts : boolean
  - dateCreation : datetime
  - dateModification : datetime
  --
  + seConnecter()
  + verifierMotDePasse()
  + isAdmin()
}

' ============================================================================
' COUCHE 2: CONFIGURATION DES EQUIPEMENTS
' ============================================================================

class Equipement {
  - hostname : string
  - ip : string
  - portSNMP : int
  - communauteSNMP : string
  - description : string
  - statut : string
  - lastStatusChange : datetime
  - snmpCategories : string
  - latitude : float
  - longitude : float
  --
  + updateStatut()
  + isAccessible()
  + getSeuils()
}

class Template {
  - nom : string
  - description : string
  - versionSNMP : string
  - categoriesMetriques : string
  --
  + getCategories()
}

class Groupe {
  - nom : string
  - description : string
  --
  + getEquipements()
}

class Tag {
  - nom : string
}

' ============================================================================
' COUCHE 3: THRESHOLDS & LIMITES
' ============================================================================

class Seuil {
  - typeMetrique : string
  - criticité : float
  --
  + verifier()
  + getSeverite()
}

' ============================================================================
' COUCHE 4: MOTEUR DE POLLING & SURVEILLANCE
' ============================================================================

class Poller {
  - frequence : int
  - derniereExecution : datetime
  - statut : string
  --
  + demarrer()
  + interrogerEquipement()
  + collecterMetriques()
  + verifierSeuils()
  + genererAlertes()
}

' ============================================================================
' COUCHE 5: MÉTRIQUES COLLECTÉES
' ============================================================================

class Metrique {
  - oid : string
  - nom : string
  - valeur : float
  - dateCollecte : datetime
  - unite : string
  --
  + sauvegarder()
}

' ============================================================================
' COUCHE 6: SYSTÈME D'ALERTES
' ============================================================================

class Alerte {
  - severite : string
  - message : string
  - dateCreation : datetime
  - dateResolution : datetime
  --
  + acquitter()
  + resoudre()
  + notifier()
}

' ============================================================================
' IMPORT/EXPORT
' ============================================================================

class FichierCSV {
  + importer()
  + exporter()
}

' ============================================================================
' ASSOCIATIONS (inchangées)
' ============================================================================

Utilisateur "1" --> "0..*" Equipement : crée/modifie
Equipement "0..*" --> "1" Template : utilise
Equipement "*" --> "*" Tag : possède
Equipement "0..*" --> "1" Groupe : appartient
Equipement "1" --> "0..*" Seuil : a
FichierCSV --> Equipement : importe/exporte
Poller --> Template : consulte\n(quoi collecter ?)
Poller --> Equipement : interroge
Poller --> Metrique : crée
Metrique --> Seuil : comparaison
Seuil --> Alerte : déclenche
Alerte --> Utilisateur : notifie/acquitte

' ============================================================================
' NOTES (inchangées)
' ============================================================================

note right of Utilisateur
  **AUTHENTIFICATION**
  Se connecte avec identifiants
  Admin ou Opérateur
end note

note right of Equipement
  **CONFIGURATION**
  Admin ajoute les hosts
  IP + SNMP + Template + Tags
end note

note right of Template
  **MODÈLE**
  Définit les métriques
  à surveiller (CPU, RAM...)
end note

note right of Seuil
  **LIMITES D'ALERTE**
  Warning / Critical
end note

note right of Poller
  **CŒUR DU SYSTÈME**
  Collecte SNMP continue
end note

note right of Metrique
  Horodatées & archivées
end note

note right of Alerte
  Alerte, notification, acquittement
end note
@enduml